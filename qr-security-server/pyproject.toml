[tool.pytest.ini_options]
# Run from qr-security-server/: pytest
testpaths  = ["tests"]
asyncio_mode = "auto"          # pytest-asyncio: all async tests run automatically
pythonpath = ["."]             # makes `app` importable without pip install
addopts    = "-ra -q --tb=short"

[tool.coverage.run]
source   = ["app"]
omit     = ["app/__pycache__/*"]

[tool.coverage.report]
show_missing = true
skip_empty   = true

# ── Ruff ─────────────────────────────────────────────────────
[tool.ruff]
line-length    = 100
target-version = "py311"

[tool.ruff.lint]
select = ["E", "F", "W", "I", "UP", "B", "SIM"]
ignore = [
    "E501",   # line length — handled by formatter
    "B008",   # function calls in default arguments (FastAPI Depends pattern)
]

[tool.ruff.lint.per-file-ignores]
"tests/*" = ["S101"]   # assert is fine in tests

# ── Black ─────────────────────────────────────────────────────
[tool.black]
line-length    = 100
target-version = ["py311"]
